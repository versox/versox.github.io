(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t,a){e.exports=a(33)},23:function(e,t,a){},25:function(e,t,a){},27:function(e,t,a){},33:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(17),i=a.n(r),o=(a(23),a(2)),l=a(3),c=a(5),u=a(4),h=a(6),d=a(35),m=a(34),p=(a(25),a(27),a(9)),g={ROOT_PATH:"/"},f=['{"instruments":[{"blocks":[1],"settings":{"typeId":1,"metadata":"123ab"}}],"blocks":{"1":{"data":[[2,3,0,0,0,0,0,0,2,3,0,0,2,3,0,0],[0,2,3,0,2,3,2,3,0,0,0,2,3,2,3,0],[0,0,2,3,0,2,3,0,0,2,3,0,0,0,2,3],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,2,0,0,3,0,0,0,0,0,0,2,3],[2,0,0,3,0,0,0,0,2,3,0,0,0,0,0,0],[0,0,0,0,1,0,1,0,0,0,2,0,0,3,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,0,1,0,1,1,1,0,1,0,1,0,1,1,1,0]]}},"id":"5bf779e1e0e4bb523109e322"}','{"instruments":[{"blocks":[1],"settings":{"typeId":1,"metadata":"123ab"}}],"blocks":{"1":{"data":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,2,3,0,0,0],[0,0,0,0,0,0,0,0,0,2,3,0,0,0,0,0],[2,3,0,0,0,2,3,0,0,0,0,0,2,3,0,0],[0,0,2,3,0,0,2,3,0,1,0,0,0,0,0,0],[0,0,0,0,1,0,0,2,3,0,0,2,3,2,3,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[2,3,0,0,0,2,3,0,0,0,2,3,0,0,2,3],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,1,0,1,0,1,0,0,0,1,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0]]}},"id":"5bf597219972bb0a043f1cb6"}','{"instruments":[{"blocks":[1],"settings":{"typeId":1,"metadata":"123ab"}}],"blocks":{"1":{"data":[[0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0],[0,0,0,1,0,0,0,1,0,1,1,0,1,1,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,2,0,0,0,3],[1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,2,0,0,0,3,0,0,0,0],[2,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,3]]}},"id":"5c01d97919bdb004cbc04d2c"}','{"name":"demo","bpm":"85","blockLength":1,"instruments":[{"blocks":[1],"settings":{"typeId":1,"metadata":"123ab"}}],"blocks":{"1":{"data":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0],[0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0],[0,1,0,0,1,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0],[0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]}}}','{"instruments":[{"blocks":[1],"settings":{"typeId":1,"metadata":"123ab"}}],"blocks":{"1":{"data":[[1,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0],[0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,0],[0,1,0,0,1,0,1,0,1,0,1,0,0,0,2,3],[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,2,3,2,3,0],[0,0,0,0,2,0,0,3,0,0,2,3,2,3,0,0],[2,3,2,3,0,0,0,0,0,2,3,0,0,0,2,3],[0,0,0,0,2,0,3,2,0,3,0,0,0,0,0,0],[0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0],[0,0,0,0,2,0,0,1,3,0,0,0,2,0,0,3],[2,0,0,1,3,0,0,0,2,0,0,1,3,0,0,0]]}},"id":"5bfe21d4c789c1108bdcfcc6"}','{"instruments":[{"blocks":[1],"settings":{"typeId":1,"metadata":"123ab"}}],"blocks":{"1":{"data":[[1,0,1,0,0,0,1,0,1,0,1,1,0,0,1,0],[0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,0,2,0,0,3,0,0,0,0],[0,0,0,0,2,3,0,0,0,0,0,0,0,0,0,0],[2,3,0,0,0,0,2,3,2,0,0,3,2,0,0,3],[0,0,2,3,2,3,0,0,0,0,0,0,0,0,0,0],[2,3,0,0,0,0,2,3,0,0,0,0,2,0,0,3],[0,0,2,3,0,0,0,0,0,0,1,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0]]}},"id":"5bfdc62ec789c1108bdcfcc4"}'],v=function(e){return e.getResponseHeader("Content-Type").includes("application/json")?JSON.parse(e.response):e.response},b=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new Promise(function(n,s){var r=new XMLHttpRequest;r.open(e,g.ROOT_PATH+"api/"+t);var i=p.get("token");i&&r.setRequestHeader("Authorization",i),r.onload=function(){this.status>=200&&this.status<300?n(r):s({status:this.status,request:r})},r.onerror=function(){s({status:this.status,request:r})},null!=a&&"undefined"!==typeof a?(r.setRequestHeader("Content-Type","application/json"),"object"===typeof a&&(a=JSON.stringify(a)),r.send(a)):r.send()})},E={getCaptcha:function(){return new Promise(function(e,t){b("GET","user/register").then(function(t){return e(v(t))}).catch(function(e){return t(e)})})},register:function(e,t){var a=new XMLHttpRequest;return a.open("POST",g.ROOT_PATH+"api/user/register",!1),a.setRequestHeader("Content-Type","application/json"),e.captcha&&(e.captcha={answer:e.captcha,key:t}),a.send(JSON.stringify(e)),a},login:function(e,t){var a=new XMLHttpRequest;if(a.open("POST",g.ROOT_PATH+"api/user/login",!1),a.setRequestHeader("Content-Type","application/json"),a.send(JSON.stringify({username:e,password:t})),200===a.status){var n=JSON.parse(a.response);p.set("user",JSON.stringify({name:n.name,username:e.toLowerCase()})||"unknown",{expires:1/48}),p.set("token",n.token,{expires:1/48}),p.set("secret",n.refreshSecret,{expires:1/48})}return a},logout:function(){p.remove("user"),p.remove("token"),p.remove("secret")},createSongDirty:function(e){var t=p.get("token");if(void 0!==t){var a=new XMLHttpRequest;if(a.open("POST",g.ROOT_PATH+"api/songs/create",!1),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Authorization",t),a.send(JSON.stringify(e)),console.log(a.response),200===a.status)return a.response.id}else console.log("not logged in!")},createSong:function(e){return new Promise(function(t,a){b("POST","songs/create",e).then(t).catch(a)})},updateSong:function(e,t){return new Promise(function(a,n){b("POST","songs/update/"+e,t).then(a).catch(n)})},getSongsDirty:function(e){var t,a=new XMLHttpRequest;t=void 0===e?g.ROOT_PATH+"api/songs":g.ROOT_PATH+"api/songs/get?userId="+e,a.open("GET",t,!1);var n=p.get("token");return n&&a.setRequestHeader("Authorization",n),a.send(),200===a.status?JSON.parse(a.response):[]},getSongs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n={};return e&&(n.userId=e),t&&(n.popular=1),a&&(n.delimiterId=a),new Promise(function(e,t){b("GET","songs"+function(e){var t="";for(var a in e)""!==t&&(t+="&"),t+=a+"="+encodeURIComponent(e[a]);return t.length>0?"?"+t:""}(n)).then(function(t){return e(v(t))}).catch(function(e){return t(e)})})},getSong:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(t,a){t(f[e])})},rateSong:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise(function(a,n){b("POST","songs/rate/"+e+(t?"/"+t:"")).then(function(){return a(!0)}).catch(function(e){return n(e)})})},fetchUser:function(e){return new Promise(function(t,a){b("GET","user/fetch/"+e).then(function(e){return t(v(e))}).catch(function(e){return a(e)})})},isLoggedIn:function(){return!!p.get("token")},getCurrentUser:function(){if(!p.get("token")||!p.get("user"))return null;try{return JSON.parse(p.get("user"))}catch(e){return null}}},y=a(7),k=a.n(y),O=function e(t){Object(o.a)(this,e),this.track=void 0===!t?t:{blocks:[1],settings:{typeId:1,metadata:"123ab"}}},N=["off","on","start","end","mid"],j={off:0,on:1,start:2,end:3,mid:4},w=function(e,t){for(var a=0;a<e.length;a++){for(var n=e[a],s=[],r=0;r<n.length;r++){var i=n[r];s.push({type:N[i],clickF:function(){"off"===this.type?this.type="on":this.type="off"},startF:function(){this.type="start"},endF:function(){this.type="end"},midF:function(){this.type="mid"}})}t.push(s)}},T=function(){function e(t){if(Object(o.a)(this,e),this.block=[],void 0!==t)w(t.data,this.block);else for(var a=0;a<12;a++){for(var n=[],s=0;s<16;s++)n.push({type:"off",clickF:function(){"off"===this.type?this.type="on":this.type="off"},startF:function(){this.type="start"},endF:function(){this.type="end"},midF:function(){this.type="mid"}});this.block.push(n)}}return Object(l.a)(e,[{key:"convertToData",value:function(){for(var e=[],t=0;t<this.block.length;t++){for(var a=this.block[t],n=[],s=0;s<a.length;s++){var r=a[s].type;n.push(j[r])}e.push(n)}return e}}]),e}(),S=["Jan","Feb","Mar","Apr","May","Jun","July","Aug","Sep","Oct","Nov","Dec"];function C(e){var t=new Date;if(t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()){var a=Math.floor((t-e)/6e4),n=Math.floor(a/60),s=a%60,r="hour";if(n>1&&(r+="s"),0===s)return n+" "+r+"  ago";var i="minute";return s>1&&(i+="s"),0===n?s+" "+i+" ago":n+" "+r+" and "+s+" "+i+" ago"}return S[e.getMonth()]+" "+e.getDate()+", "+e.getFullYear()}var D=function(){function e(t){Object(o.a)(this,e),this.blocks=[],this.tracks=[],void 0!==t?(this.name=t.name,this.bpm=t.bpm,this.blockLength=t.blockLength,this.createDate=new Date(t.createDate),this.updateDate=t.updateDate?new Date(t.updateDate):null,this.author=t.user.name,this.username=t.user.username,this.ratings=t.ratings,this.id=t.id):(this.name="awesome song",this.bpm=120,this.blockLength=1),this.setKey(),this.loaded=!1,this.progressListeners=[]}return Object(l.a)(e,[{key:"setKey",value:function(e,t){this.freq=e||"C",this.keyType=t||"Maj",this.key=[],this.key[11]=this.freq+"3";for(var a="Maj"===t?[2,2,1,2,2,2,1,2,2,1,2]:[2,1,2,2,1,2,2,2,1,2,2],n=10,s=0;n>=0;n--,s++)this.key[n]=k.a.Frequency(this.key[n+1]).transpose(a[s]);this.synth&&this.synth.releaseAll()}},{key:"load",value:function(e){if(this.blocks.push(null),void 0===this.id||void 0===e)this.blocks.push(new T),this.tracks.push(new O);else{for(var t=0;t<e.instruments.length;t++)this.tracks.push(new O(e.instruments[t]));for(var a=1;a<=this.blockLength;a++){var n=new T(e.blocks[a]);this.blocks.push(n)}}this.activeBlock=this.blocks[1].block,this.loaded=!0}},{key:"init",value:function(){var e=this;k.a.Transport.cancel(),this.synth=new k.a.PolySynth(6,k.a.Synth).toMaster(),this.count=0,this.loop=new k.a.Loop(function(t){for(var a=0;a<12;a++)switch(e.activeBlock[a][e.count].type){case"on":e.synth.triggerAttackRelease(e.key[a],"16n",t);break;case"start":e.synth.triggerAttack(e.key[a],t);break;case"end":e.synth.triggerRelease(e.key[a],t)}e.count>=15?e.count=0:e.count++},"16n")}},{key:"play",value:function(){this.initialized||(this.init(),this.initialized=!0),k.a.Transport.loopEnd=this.blockLength+"m",k.a.Transport.loop=!0,k.a.Transport.bpm.value=this.bpm,this.progressTickEvent=k.a.Transport.scheduleRepeat(function(e){var t=k.a.Transport.seconds/k.a.Transport.loopEnd;if(!(t<0||t>1)){var a=!0,n=!1,s=void 0;try{for(var r,i=this.progressListeners.keys()[Symbol.iterator]();!(a=(r=i.next()).done);a=!0){var o=r.value;this.progressListeners[o](t)}}catch(l){n=!0,s=l}finally{try{a||null==i.return||i.return()}finally{if(n)throw s}}console.log()}}.bind(this),"8i"),this.loop.start(0),k.a.Transport.start(),this.pauseTime&&(k.a.Transport.seconds=this.pauseTime)}},{key:"pause",value:function(){this.pauseTime=k.a.Transport.seconds,this.loop.stop(0),k.a.Transport.stop(),this.synth.releaseAll(),k.a.Transport.clear(this.progressTickEvent)}},{key:"save",value:function(){var e=this;if(this.id)return E.updateSong(this.id,this.getSendableSong());var t=E.createSong(this.getSendableSong());return t.then(function(t){var a=JSON.parse(t.response);e.id=a.id}),t}},{key:"getSendableSong",value:function(){for(var e={name:this.name,bpm:this.bpm,blockLength:this.blockLength,instruments:this.tracks.map(function(e){return e.track}),blocks:{}},t=1;t<=this.blocks.length-1;t++)e.blocks[t]={data:this.blocks[t].convertToData()};return e}},{key:"getFormattedCreate",value:function(){return C(this.createDate)}},{key:"getFormattedUpdate",value:function(){return C(this.updateDate)}},{key:"hasBeenUpdated",value:function(){return this.updateDate&&Math.abs(this.createDate-this.updateDate)>=50}},{key:"addProgressListener",value:function(e,t){this.progressListeners.push(t.bind(e))}},{key:"getId",value:function(){return this.id?this.id:null}}]),e}(),P=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).selectedTrack=0,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"addTrack",value:function(){}},{key:"setName",value:function(e){this.name=e}},{key:"setBPM",value:function(e){this.bpm=e,k.a.Transport.bpm.value=this.bpm}}]),t}(D),R=(n.Component,function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state=e.tile,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"onMouseMove",value:function(e){}},{key:"onMouseDown",value:function(e){this.props.dragger.active=this.props.line,this.props.dragger.start=this}},{key:"onMouseUp",value:function(e){this.props.line===this.props.dragger.active&&(this.props.dragger.start===this?this.state.clickF():(this.props.dragger.start.state.startF(),this.props.dragger.start.forceUpdate(),this.state.endF()),this.forceUpdate()),this.props.dragger.active=null}},{key:"render",value:function(){return s.a.createElement("div",{class:"tile "+this.state.type,onMouseDown:this.onMouseDown.bind(this),onMouseUp:this.onMouseUp.bind(this),onMouseMove:this.onMouseMove.bind(this)})}}]),t}(n.Component)),M=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){for(var e=[],t=0;t<16;t++)e.push(s.a.createElement(R,{tile:this.props.line[t],line:this.props.lineNum,dragger:this.props.dragger}));return s.a.createElement("div",{class:"line"},e)}}]),t}(n.Component),L=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).dragger={active:-1,start:null},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){for(var e=[],t=0;t<12;t++)e.push(s.a.createElement(M,{line:this.props.block[t],lineNum:t,dragger:this.dragger}));return s.a.createElement("div",{id:"blockEdit"},e)}}]),t}(n.Component),A=a(12),I=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null)}}]),t}(n.Component),x=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"remove",value:function(){this.props.remove(this)}},{key:"render",value:function(){return s.a.createElement("div",{className:"track"},s.a.createElement("h1",{onClick:this.remove.bind(this)},this.props.id),s.a.createElement(I,null))}}]),t}(n.Component),H=(n.Component,function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={playing:!1,error:!1,name:"",bpm:120,key:"",keyType:""},a.keysArray=["C","D","E","F","G","A","B"],a.keyOptions=a.keysArray.map(function(e){return s.a.createElement("option",null,e)}),a.ready=!1,a.songId=e.match.params.id,"new"===a.songId?(a.song=new P,a.song.load(),a.song.init(),a.ready=!0):void 0!==a.songId&&E.getSong(a.songId).then(function(e){return JSON.parse(e)}).then(function(e){a.song=new P(e),a.song.load(e),a.song.init(),a.ready=!0,a.setState({name:a.song.name,bpm:a.song.bpm,key:a.song.freq,keyType:a.song.keyType}),a.forceUpdate()}).catch(function(e){a.state.error=!0,a.state.errComp=s.a.createElement("h1",null," Could not load song: ",e," ")}),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){0}},{key:"scheduleButtonReset",value:function(){var e=this;this.notificationTask&&clearTimeout(this.notificationTask),this.notificationTask=setTimeout(function(){return e.setState({saveBtn:null})},2e3)}},{key:"componentWillUnmount",value:function(){this.notificationTask&&clearTimeout(this.notificationTask)}},{key:"handleToggle",value:function(){this.setState(function(e){return{playing:!e.playing}}),this.state.playing?this.song.pause():this.song.play()}},{key:"onSave",value:function(e){var t=this;if(e.preventDefault(),!this.song.name||""===this.song.name)return this.setState({saveBtn:3}),void this.scheduleButtonReset();this.setState({saveBtn:1}),this.song.save().then(function(){t.setState({saveBtn:2}),t.scheduleButtonReset()}).catch(function(){t.setState({saveBtn:3}),t.scheduleButtonReset()})}},{key:"onChange",value:function(e){var t={},a=e.target.value;switch(e.target.id){case"name":this.song.setName(a);break;case"bpm":""!==a&&(a<1?a=1:a>500&&(a=500),this.song.setBPM(a));break;case"keyType":this.song.setKey(this.state.key,a);break;case"key":this.song.setKey(a,this.state.keyType)}t[e.target.id]=a,this.setState(t)}},{key:"render",value:function(){var e=this;return this.state.error?this.state.errComp:this.song&&this.ready?s.a.createElement("div",{className:"container econtainer",style:{"margin-top":"40px"}},s.a.createElement("div",{className:"editor"},s.a.createElement("div",{className:"editor-header"},s.a.createElement("span",{className:"header-left"},s.a.createElement("i",{onClick:this.handleToggle.bind(this),className:"fa "+(this.state.playing?"fa-stop":"fa-play")}),s.a.createElement("div",{className:"header-controls"},s.a.createElement("span",null,"BPM "),s.a.createElement("input",{value:this.state.bpm,id:"bpm",onChange:function(t){return e.onChange(t)},type:"number"}),s.a.createElement("span",null,"Key "),s.a.createElement("select",{id:"key",value:this.state.key,onChange:function(t){return e.onChange(t)}},this.keyOptions),s.a.createElement("select",{onChange:function(t){return e.onChange(t)},id:"keyType",value:this.state.keyType},s.a.createElement("option",null,"Maj"),s.a.createElement("option",null,"min")))),s.a.createElement("div",{className:"song-name"},s.a.createElement("form",{onSubmit:function(t){return e.onSave(t)}},s.a.createElement("input",{required:!0,onChange:function(t){return e.onChange(t)},value:this.state.name,id:"name",type:"text",placeholder:"untitled",className:"name-input"}),s.a.createElement("input",{type:"submit",style:{minWidth:"120px"},value:this.state.saveBtn?1===this.state.saveBtn?"Loading...":2===this.state.saveBtn?"Saved!":"Failed!":"Save",disabled:!!this.state.saveBtn,className:"btn "+(this.state.saveBtn?3!==this.state.saveBtn?"btn-success":"btn-danger":"btn-light")})))),s.a.createElement("div",{className:"row"},s.a.createElement(L,{block:this.song.activeBlock})),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("br",null))):s.a.createElement("div",null," ")}}]),t}(n.Component)),B=a(36),U=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={hover:void 0,userValue:a.props.song.ratings?a.props.song.ratings.currentUserRating:null},a.value=4.5,a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"onMouseEnter",value:function(e){this.props.changeable&&this.setState({hover:e})}},{key:"onMouseLeave",value:function(){this.props.changeable&&this.setState({hover:void 0})}},{key:"setRating",value:function(e){var t=this;this.props.changeable&&(e=e===this.state.userValue?null:e,E.rateSong(this.props.song.id,e).then(function(){t.setState({userValue:e})}).catch(function(e){console.log(e)}))}},{key:"render",value:function(){for(var e=[],t=1;t<=5;t++){var a="star";Math.ceil(this.props.value)>=t&&(this.props.value<t?a+=" half":a+=" full"),this.state.userValue&&this.state.userValue>=t&&(a+=" active"),this.state.hover&&this.state.hover>=t&&(a+=" hover"),e.push(s.a.createElement("div",{className:a,onMouseEnter:this.onMouseEnter.bind(this,t),onMouseLeave:this.onMouseLeave.bind(this),onClick:this.setRating.bind(this,t)}))}var n="song-rating"+(this.props.changeable?" changeable":"");return s.a.createElement("div",{className:n},e)}}]),t}(n.Component),F=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={redirect:!1,to:"",playBtn:"play-btn",playing:!1},a.song=e.song,a.song.addProgressListener(Object(A.a)(Object(A.a)(a)),function(e){a.setState({progress:Math.floor(100*e)+"%"})}),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"onEdit",value:function(){var e=this.song.id||"";this.setState({redirect:!0,to:"/editor/"+e})}},{key:"onPlayPause",value:function(){var e=this;this.loading||(this.state.playing?(this.setState({playBtn:"play-btn",playing:!1}),this.song.pause()):this.song.loaded?(this.setState({playBtn:"pause-btn",playing:!0}),this.song.play()):(this.loading=!0,E.getSong(this.song.id,"composition").then(function(e){return JSON.parse(e)}).then(function(t){e.song.load(t),e.loading=!1,e.onPlayPause()}).catch(function(){})))}},{key:"render",value:function(){var e=this;return this.state.redirect?s.a.createElement(B.a,{to:this.state.to}):s.a.createElement("li",null,s.a.createElement("div",{className:"song-header",style:{background:"#007eff45"}},s.a.createElement("div",null,s.a.createElement("button",{onClick:function(){return e.onPlayPause()},className:"btn btn-light playback-btn "+this.state.playBtn}),s.a.createElement("div",{className:"song-title"},this.song.name)),s.a.createElement("div",null,E.getCurrentUser()&&E.getCurrentUser().username===this.song.username&&s.a.createElement("div",{className:"buttons-container"},s.a.createElement("button",{onClick:function(){return e.onEdit()},className:"btn btn-light"},s.a.createElement("i",{className:"fa fa-pencil"})),s.a.createElement("button",{className:"btn btn-light"},s.a.createElement("i",{className:"fa fa-trash"}))),s.a.createElement("a",{href:g.ROOT_PATH+"profile/"+this.song.username,className:"song-artist"},s.a.createElement("div",{className:"name"},this.song.author),s.a.createElement("div",{className:"username"},"@",this.song.username))),s.a.createElement("div",{className:"play-progress",style:{width:this.state.progress}})),s.a.createElement("div",{className:"song-body"},s.a.createElement(U,{song:this.song,changeable:!0,value:4.5}),s.a.createElement("div",{className:"song-dates"},s.a.createElement("span",{className:"song-creation-date"},"Created ",this.song.getFormattedCreate()),s.a.createElement("span",{className:"song-update-date"},this.song.hasBeenUpdated()?"Updated "+this.song.getFormattedUpdate():""))))}}]),t}(n.Component),J=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).songs=[],a.state={loading:!1},a.loadMore(),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"loadMore",value:function(){if(!this.state.loading){this.setState({loading:!0});var e=[{name:"Party Time",bpm:"120",blockLength:"1",createDate:"December 17, 1995 03:24:00",updateDate:"December 17, 1995 03:24:00",user:{name:"briltz",username:"jbriltz"},ratings:7,id:0},{name:"Change key to F",bpm:"80",blockLength:"1",createDate:"December 17, 1995 03:24:00",updateDate:"December 17, 1995 03:24:00",user:{name:"briltz",username:"jbriltz"},ratings:7,id:1},{name:"yhA yeet",bpm:"90",blockLength:"1",createDate:"December 17, 1995 03:24:00",updateDate:"December 17, 1995 03:24:00",user:{name:"jake",username:"jdudarewicz"},ratings:7,id:2},{name:"Demo",bpm:"85",blockLength:"1",createDate:"December 17, 1995 03:24:00",updateDate:"December 17, 1995 03:24:00",user:{name:"Carson",username:"verso"},ratings:7,id:3},{name:"Winter Night",bpm:"40",blockLength:"1",createDate:"December 17, 1995 03:24:00",updateDate:"December 17, 1995 03:24:00",user:{name:"briltz",username:"jbriltz"},ratings:7,id:4},{name:"Easily",bpm:"50",blockLength:"1",createDate:"December 17, 1995 03:24:00",updateDate:"December 17, 1995 03:24:00",user:{name:"briltz",username:"jbriltz"},ratings:7,id:5}];for(var t in this.delimiterId=null,e){var a=e[t];a.hasOwnProperty("delimiterId")?this.delimiterId=a.delimiterId:this.songs.push(s.a.createElement(F,{song:new D(a)}))}this.setState({loading:!1,loaded:!0})}}},{key:"render",value:function(){return s.a.createElement("div",null,0===this.songs.length&&this.state.loaded?s.a.createElement("p",{className:"text-center"},"Looks like there are no songs to display :("):s.a.createElement("ul",{className:"song-list"},this.songs),(this.state.loading||this.delimiterId)&&s.a.createElement("div",{className:"song-list-footer"},this.delimiterId?s.a.createElement("button",{className:"btn btn-light load-more-btn",disabled:this.state.loading,onClick:this.loadMore.bind(this)},this.state.loading?"Loading...":"Load More"):s.a.createElement("div",{className:"loading"},"Loading...")))}}]),t}(n.Component),q=a(32),_=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).slide1={backgroundImage:"url("+g.ROOT_PATH+"assets/Slide1.png)"},a.slide2={backgroundImage:"url("+g.ROOT_PATH+"assets/Slide2.png)"},a.slide3={backgroundImage:"url("+g.ROOT_PATH+"assets/Slide3.png)"},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("header",null,s.a.createElement("div",{id:"carouselExampleIndicators",className:"carousel slide","data-ride":"carousel"},s.a.createElement("ol",{className:"carousel-indicators"},s.a.createElement("li",{"data-target":"#carouselExampleIndicators","data-slide-to":"0",className:"active"}),s.a.createElement("li",{"data-target":"#carouselExampleIndicators","data-slide-to":"1"}),s.a.createElement("li",{"data-target":"#carouselExampleIndicators","data-slide-to":"2"})),s.a.createElement("div",{className:"carousel-inner",role:"listbox"},s.a.createElement("div",{className:"carousel-item active",style:this.slide1},s.a.createElement("div",{class:"slide"},s.a.createElement("h1",{class:"slide-cap"},"Create 8-Bit Music in Just Minutes"))),s.a.createElement("div",{className:"carousel-item",style:this.slide2},s.a.createElement("div",{class:"slide"},s.a.createElement("h1",{class:"slide-cap"},"Perfect For Retro-Style Games"))),s.a.createElement("div",{className:"carousel-item",style:this.slide3},s.a.createElement("div",{class:"slide"},s.a.createElement("h1",{class:"slide-cap"},"Get Started With Our Free Chiptune Editor")))),s.a.createElement("a",{className:"carousel-control-prev",href:"#carouselExampleIndicators",role:"button","data-slide":"prev"},s.a.createElement("span",{className:"carousel-control-prev-icon","aria-hidden":"true"}),s.a.createElement("span",{className:"sr-only"},"Previous")),s.a.createElement("a",{className:"carousel-control-next",href:"#carouselExampleIndicators",role:"button","data-slide":"next"},s.a.createElement("span",{className:"carousel-control-next-icon","aria-hidden":"true"}),s.a.createElement("span",{className:"sr-only"},"Next")))),s.a.createElement("div",{className:"container content"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-lg-9 col-md-8"},s.a.createElement("h3",null,"Popular Songs"),s.a.createElement(J,{popular:!0})),s.a.createElement("div",{className:"col-lg-3 col-md-4"},s.a.createElement("h3",null,"About"),s.a.createElement("p",null,"Chip Share is a chiptune song sharing website! It is developed using the ",s.a.createElement("a",{href:"https://reactjs.org/"},"React")," framework for the front-end, and ",s.a.createElement("a",{href:"https://expressjs.com/"},"Express")," for the back-end."),s.a.createElement("p",null,"This school project has been collectively developed by Jake, Carson, Mishel, and Alex at Ryerson University, Toronto, Canada."),s.a.createElement("h3",null,"Get Started"),s.a.createElement("p",null,"Try out our custom chiptune editor to create your very own songs! Simply ",s.a.createElement(q.a,{to:"/register"},"create an account")," and play around to master the art of 8-bit music!")))))}}]),t}(n.Component),z=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={fieldErrors:{},error:null,redirect:null},a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"onSubmit",value:function(e){if(e.preventDefault(),0!==this.refs.username.value.length&&0!==this.refs.password.value.length){var t=E.login(this.refs.username.value,this.refs.password.value);switch(t.status){case 200:this.setState({redirect:g.ROOT_PATH+"profile/"+this.refs.username.value.toLowerCase()});break;case 400:var a=null;try{a=JSON.parse(t.response).fieldErrors}catch(s){}this.setState({error:null,fieldErrors:a});break;default:var n="Unknown error occurred.";try{n=JSON.parse(t.response).message}catch(s){}this.setState({error:n.charAt(0).toUpperCase()+n.substring(1)+".",fieldErrors:{}})}}else this.setState({errors:null,fieldErrors:{username:0===this.refs.username.value.length?"This field is required.":null,password:0===this.refs.password.value.length?"This field is required.":null}})}},{key:"hideError",value:function(e){var t=this.state.fieldErrors;delete t[e],this.setState({fieldErrors:t})}},{key:"render",value:function(){var e=this;return this.state.redirect?s.a.createElement(B.a,{to:this.state.redirect}):s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-lg-4 offset-lg-4 col-sm-6 offset-sm-3 col-10 offset-1"},s.a.createElement("form",{onSubmit:function(t){return e.onSubmit(t)},className:"form-login"},s.a.createElement("h1",null,"Login"),s.a.createElement("div",{className:"form-group"},s.a.createElement("input",{ref:"username",onChange:function(){return e.state.fieldErrors.username?e.hideError("username"):{}},type:"text",className:"form-control"+(this.state.fieldErrors.username?" is-invalid":""),placeholder:"Username"}),s.a.createElement("div",{className:"invalid-feedback"},this.state.fieldErrors.username||"")),s.a.createElement("div",{className:"form-group"},s.a.createElement("input",{ref:"password",onChange:function(){return e.state.fieldErrors.password?e.hideError("password"):{}},type:"password",className:"form-control"+(this.state.fieldErrors.password?" is-invalid":""),placeholder:"Password"}),s.a.createElement("div",{className:"invalid-feedback"},this.state.fieldErrors.password||"")),s.a.createElement("div",{className:"form-group"},this.state.error&&s.a.createElement("div",{style:{margin:"-10px 0 5px"}},s.a.createElement("small",{className:"text-warning"},this.state.error)),s.a.createElement("button",{className:"btn btn-primary",type:"submit"},"Login"))),s.a.createElement("hr",null),s.a.createElement("div",{className:"register-prompt"},s.a.createElement("h2",null,"Don't have an account?"),s.a.createElement(q.a,{to:"/register"},"Register Here")))))}}]),t}(n.Component),V=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"getValue",value:function(){return this.refs.input.value}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"form-group"},s.a.createElement("input",{ref:"input",name:this.props.name,onChange:function(){return e.props.fieldErrors[e.props.name]?e.props.hideError(e.props.name):{}},type:this.props.type||"text",className:"form-control"+(this.props.fieldErrors[this.props.name]?" is-invalid":""),placeholder:this.props.placeholder||""}),s.a.createElement("div",{className:"invalid-feedback"},this.props.fieldErrors[this.props.name]||""))}}]),t}(n.Component),G=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={fieldErrors:{},error:null,redirect:null,captcha:null},E.getCaptcha().then(function(e){a.captchaKey=e.captcha.key,a.setState({captcha:s.a.createElement("div",{dangerouslySetInnerHTML:{__html:e.captcha.image}})})}).catch(function(){a.setState({captcha:"Failed to load!"})}),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"onSubmit",value:function(e){if(e.preventDefault(),!(this.ensureErrorCorrection&&Object.keys(this.state.fieldErrors).length>0)){var t={name:this.refs.name.getValue(),username:this.refs.username.getValue(),password:this.refs.password.getValue(),captcha:this.refs.captcha.getValue()},a=!1;for(var n in t)0===t[n].length&&(this.state.fieldErrors[n]="This field is required.",this.forceUpdate(),a=!0);if(this.refs["repeat-password"].getValue()!==this.refs.password.getValue()&&(this.state.fieldErrors["repeat-password"]="Passwords do not match.",this.forceUpdate(),a=!0),!a){var s=E.register(t,this.captchaKey);switch(s.status){case 201:var r=E.login(t.username,t.password);this.setState({redirect:200===r.status?g.ROOT_PATH+"profile/"+t.username.toLowerCase():g.ROOT_PATH+"login"});break;case 400:var i=null;try{var o=JSON.parse(s.response);i=o.fieldErrors||{},o.captchaError&&(i.captcha=o.captchaError)}catch(c){}this.setState({error:null,fieldErrors:i}),this.ensureErrorCorrection=!0;break;default:var l="Unknown error occurred.";try{l=JSON.parse(s.response).message}catch(c){}this.setState({error:l.charAt(0).toUpperCase()+l.substring(1)+".",fieldErrors:{}})}}}}},{key:"hideError",value:function(e){var t=this.state.fieldErrors;delete t[e],this.setState({fieldErrors:t})}},{key:"render",value:function(){var e=this;return this.state.redirect?s.a.createElement(B.a,{to:this.state.redirect}):s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-lg-4 offset-lg-4 col-sm-6 offset-sm-3 col-10 offset-1"},s.a.createElement("form",{onSubmit:function(t){return e.onSubmit(t)},className:"form-login"},s.a.createElement("h1",null,"Register"),s.a.createElement(V,{ref:"name",name:"name",placeholder:"Name",fieldErrors:this.state.fieldErrors,hideError:this.hideError.bind(this)}),s.a.createElement(V,{ref:"username",name:"username",placeholder:"Username",fieldErrors:this.state.fieldErrors,hideError:this.hideError.bind(this)}),s.a.createElement(V,{ref:"password",name:"password",type:"password",placeholder:"Password",fieldErrors:this.state.fieldErrors,hideError:this.hideError.bind(this)}),s.a.createElement(V,{ref:"repeat-password",name:"repeat-password",type:"password",placeholder:"Repeat Password",fieldErrors:this.state.fieldErrors,hideError:this.hideError.bind(this)}),s.a.createElement("div",{className:"captcha-group"},s.a.createElement("div",{className:"captcha-container"},this.state.captcha||"Loading captcha..."),s.a.createElement(V,{ref:"captcha",name:"captcha",placeholder:"Captcha Answer",fieldErrors:this.state.fieldErrors,hideError:this.hideError.bind(this)})),s.a.createElement("button",{className:"btn btn-primary",type:"submit"},"Register")),s.a.createElement("hr",null),s.a.createElement("div",{className:"register-prompt"},s.a.createElement("h2",null,"Already have an account?"),s.a.createElement(q.a,{to:"/login"},"Login Here")))))}}]),t}(n.Component),K=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={loading:!0},a.props.match&&a.props.match.params&&a.props.match.params.username?E.fetchUser(a.props.match.params.username).then(function(e){a.setState({loading:!1,user:e})}).catch(function(e){404===e.status&&a.setState({loading:!1,user:null})}):(a.state.loading=!1,a.state.user=null),a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.state.loading?s.a.createElement("div",{className:"info-box"},s.a.createElement("p",null,"Loading...")):s.a.createElement("div",null,s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-12 col-lg-8 offset-lg-2"},this.state.user?s.a.createElement("div",null,s.a.createElement("h1",{className:"account-name"},this.state.user.name),s.a.createElement("span",{className:"account-username"},"@",this.state.user.username),s.a.createElement(J,{userId:this.state.user.id})):s.a.createElement("div",{className:"info-box"},s.a.createElement("h1",null,"User Not Found"),s.a.createElement("p",null,"This profile page does not exist."))))))}}]),t}(n.Component),W=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("li",{className:"dropdown",onClick:this.toggleOpen},s.a.createElement("a",{href:"#",className:"nav-link dropdown-toggle","data-toggle":"dropdown"},this.props.item.title),s.a.createElement("div",{className:"dropdown-menu"},this.props.item.items.map(function(e){return s.a.createElement("a",{className:"dropdown-item",href:g.ROOT_PATH+e.path},e.title)})))}}]),t}(n.Component),X=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return E.logout(),s.a.createElement(B.a,{to:g.ROOT_PATH})}}]),t}(n.Component),Y=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).user=E.getCurrentUser(),a.menu=[{title:"Browse",path:"/"},{title:"Create",path:"/editor/new"},{title:"My Songs",path:"/profile/"+(a.user?a.user.username:""),userOnly:!0}],a}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.menu.map(function(t){if(!t.userOnly||e.user)return t.items?s.a.createElement(W,{item:t}):s.a.createElement("li",{className:"nav-item"+(t.items?" dropdown":"")},s.a.createElement("a",{href:t.path,className:"nav-link "+(window.location.pathname===t.path?"active":"")},t.title))});return s.a.createElement("div",{className:"App"},s.a.createElement(d.a,{basename:g.ROOT_PATH},s.a.createElement("div",null,s.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark fixed-top"},s.a.createElement("div",{className:"container"},s.a.createElement("a",{className:"navbar-brand",href:g.ROOT_PATH},"Chip Share"),s.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarResponsive","aria-controls":"navbarResponsive","aria-expanded":"false","aria-label":"Toggle navigation"},s.a.createElement("span",{className:"navbar-toggler-icon"})),s.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarResponsive"},s.a.createElement("ul",{className:"navbar-nav mr-auto"},t),s.a.createElement(m.a,{path:"/",component:function(){var e=E.getCurrentUser();return s.a.createElement("ul",{className:"navbar-nav ml-auto"},e?s.a.createElement("li",{className:"nav-item dropdown"},s.a.createElement("a",{className:"nav-link dropdown-toggle",href:"#",id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"Logged in as: ",e.name),s.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"navbarDropdown"},s.a.createElement("a",{className:"dropdown-item",href:g.ROOT_PATH+"logout"},"Log Out"))):s.a.createElement("a",{className:"nav-link",href:g.ROOT_PATH+"login"},"Log In / Register"))}})))),s.a.createElement(m.a,{path:"/",exact:!0,component:_}),s.a.createElement(m.a,{path:"/editor",component:H}),s.a.createElement(m.a,{path:"/editor/:id",component:H}),s.a.createElement(m.a,{path:"/login",component:z}),s.a.createElement(m.a,{path:"/register",component:G}),s.a.createElement(m.a,{path:"/profile/:username?",component:K}),s.a.createElement(m.a,{path:"/logout",component:X}))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(Y,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[18,2,1]]]);
//# sourceMappingURL=main.0e568c1a.chunk.js.map